import"./modulepreload-polyfill-B5Qt9EMX.js";import{loadProducts as T}from"./products-BnZz_0H0.js";import{l as B,u as M}from"./style-BZo5ew0Z.js";window.addEventListener("DOMContentLoaded",async()=>{const w=await T(),b=await B();window.inventory=b;const d={};w.forEach(e=>d[e.name]=e);let u=0,g=0,r=0,i=0;const x=new Date,m={factory:[],shipping:[],port:[],warehouse:[],installed:[],unknown:[]},v=[],k=["enova warehouse","back warehouse"];b.forEach(e=>{var c;const t=d[e.model]||d[e.product],l=(t==null?void 0:t.isPublicAsset)||!1,a=parseFloat(t==null?void 0:t.price)||0;let n=null;const o=((c=e.location)==null?void 0:c.toLowerCase())||"";if(o.includes("public")||o.includes("arrived")||o.includes("installed")?n="installed":k.includes(o)?n="warehouse":o.includes("port")?n="port":o.includes("shipping")?n="shipping":o.includes("factory")?n="factory":n="unknown",n&&n!=="installed"&&m[n].push(e),l||o.includes("public")){u++,r+=a;const p=parseFloat(t==null?void 0:t.depreciationRate)/100||.15,s=new Date(e.installedDate||e.lastAction||e.created),h=(x-s)/(365.25*24*3600*1e3),P=a*Math.pow(1-p,h);v.push({chargerId:e.chargerId,model:e.model,installDate:s.toLocaleDateString(),originalValue:a,depreciationRate:p,years:h.toFixed(2),currentValue:P.toFixed(0),location:e.location})}else t&&(g++,i+=a)});const f=["bg-red-400 dark:bg-red-700","bg-orange-400 dark:bg-orange-700","bg-yellow-400 dark:bg-yellow-700","bg-green-400 dark:bg-green-700","bg-blue-400 dark:bg-blue-700","bg-indigo-400 dark:bg-indigo-700","bg-purple-400 dark:bg-purple-700"],$=[{label:"Public Chargers",value:u,value2:`$${r.toLocaleString()}`},{label:"Inventory Chargers",value:g,value2:`$${i.toLocaleString()}`},{label:"Total Chargers",value:u+g,value2:""}].map((e,t)=>({...e,color:f[t%f.length]}));function C(){document.getElementById("kpi-cards").innerHTML=$.map(e=>`
      <div class="${e.color} rounded-xl p-6 text-center shadow text-white">
        <div class="text-2xl font-bold">${e.value}</div>
        <div class="text-lg">${e.label}</div>
        ${e.value2?`<div class="text-lg font-semibold mt-1">${e.value2}</div>`:""}
      </div>
    `).join("")}function I(){var t,l;const e=(t=document.getElementById("assetDonut"))==null?void 0:t.parentElement;if(r===0&&i===0)e.innerHTML='<div class="text-gray-400 text-center pt-24">No asset data to display</div>';else{const a=(l=document.getElementById("assetDonut"))==null?void 0:l.getContext("2d");a&&new Chart(a,{type:"doughnut",data:{labels:["Public Assets","Inventory"],datasets:[{data:[r,i],backgroundColor:["#8b5cf6","#38bdf8"],borderWidth:2,borderColor:"#fff"}]},options:{plugins:{legend:{position:"bottom"}},maintainAspectRatio:!1}})}}function D(e){const t=[{key:"factory",label:"Factory"},{key:"shipping",label:"Shipping"},{key:"port",label:"Port"},{key:"warehouse",label:"Warehouse"}],l=t.reduce((a,n)=>{var o;return a+(((o=e[n.key])==null?void 0:o.length)||0)},0);if(l===0){document.getElementById("milestone-progress").innerHTML='<div class="text-gray-400 text-center">No assets in transit.</div>';return}document.getElementById("milestone-progress").innerHTML=`
      <div class="flex items-center justify-between mb-2">
        ${t.map(a=>{var n;return`
          <div class="flex flex-col items-center flex-1">
            <div class="text-lg font-semibold">${((n=e[a.key])==null?void 0:n.length)||0}</div>
            <div class="text-xs text-gray-600">${a.label}</div>
          </div>
        `}).join("")}
      </div>
      <div class="flex w-full h-4 rounded bg-gray-200 overflow-hidden shadow">
        ${t.map((a,n)=>{var s;const o=((s=e[a.key])==null?void 0:s.length)||0,c=l?o/l*100:0;return`<div class="${["bg-purple-400","bg-blue-400","bg-yellow-400","bg-green-400"][n%4]}" style="width:${c}%;"></div>`}).join("")}
      </div>
    `}function L(){return(window.inventory||[]).map(e=>e.chargerId)}function E(e){const t=e.reduce((n,o)=>n+Number(o.originalValue),0),l=e.reduce((n,o)=>n+Number(o.currentValue),0),a=t-l;document.getElementById("depreciation-summary").innerHTML=`Total Depreciation This Year: <span class="text-purple-600">$${a.toLocaleString()}</span>`}const y=document.getElementById("moveToPortBtn");y&&(y.onclick=()=>{const e=L();M(e,"Port")}),C(),I(),D(m),E(v)});
